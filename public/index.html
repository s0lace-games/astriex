<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Astriex</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Instrument+Serif:ital@0;1&display=swap');
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root { --black: #0a0a0a; --white: #f5f5f0; --gray: #888; }
    html, body { height: 100%; background: var(--black); color: var(--white); font-family: 'Space Mono', monospace; overflow: hidden; }
    body::before {
      content: ''; position: fixed; inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 100; opacity: 0.4;
    }
    .container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; padding: 2rem; }
    .wordmark { font-family: 'Instrument Serif', serif; font-style: italic; font-size: clamp(3rem, 8vw, 6rem); color: var(--white); letter-spacing: -0.02em; line-height: 1; margin-bottom: 0.15em; animation: fade-up 0.8s ease both; }
    .tagline { font-size: 0.65rem; color: var(--gray); letter-spacing: 0.25em; text-transform: uppercase; margin-bottom: 3rem; animation: fade-up 0.8s 0.1s ease both; }
    .search-wrap { display: flex; width: 100%; max-width: 560px; border: 1px solid #333; background: #111; animation: fade-up 0.8s 0.2s ease both; transition: border-color 0.2s; }
    .search-wrap:focus-within { border-color: var(--white); }
    #url-input { flex: 1; background: transparent; border: none; outline: none; color: var(--white); font-family: 'Space Mono', monospace; font-size: 0.8rem; padding: 1rem 1.2rem; caret-color: var(--white); }
    #url-input::placeholder { color: #444; }
    #go-btn { background: var(--white); color: var(--black); border: none; padding: 0 1.4rem; font-family: 'Space Mono', monospace; font-size: 0.7rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; cursor: pointer; transition: background 0.15s; }
    #go-btn:hover { background: var(--gray); }
    .shortcuts { display: flex; gap: 1.5rem; margin-top: 2rem; animation: fade-up 0.8s 0.3s ease both; }
    .shortcut { font-size: 0.6rem; color: #555; letter-spacing: 0.1em; text-transform: uppercase; cursor: pointer; transition: color 0.2s; }
    .shortcut:hover { color: var(--white); }
    .corner { position: fixed; font-size: 0.55rem; letter-spacing: 0.15em; text-transform: uppercase; color: #333; }
    .corner.tl { top: 1.5rem; left: 1.5rem; }
    .corner.br { bottom: 1.5rem; right: 1.5rem; }
    #status { margin-top: 1rem; font-size: 0.6rem; color: #555; letter-spacing: 0.1em; min-height: 1em; }
    @keyframes fade-up { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
<span class="corner tl">UV // Proxy</span>
<span class="corner br">Powered by Ultraviolet</span>
<div class="container">
  <h1 class="wordmark">Astriex</h1>
  <p class="tagline">Ultraviolet Web Proxy</p>
  <div class="search-wrap">
    <input id="url-input" type="text" placeholder="enter a url or search query..." autocomplete="off" spellcheck="false" />
    <button id="go-btn">Go</button>
  </div>
  <div class="shortcuts">
    <span class="shortcut" onclick="setInput('https://www.youtube.com')">YouTube</span>
    <span class="shortcut" onclick="setInput('https://www.google.com')">Google</span>
    <span class="shortcut" onclick="setInput('https://discord.com/app')">Discord</span>
    <span class="shortcut" onclick="setInput('https://www.reddit.com')">Reddit</span>
  </div>
  <div id="status">loading...</div>
</div>

<script src="/uv/uv.bundle.js"></script>
<script src="/uv/uv.config.js"></script>
<script>
  const status = document.getElementById("status");

  // Hardcoded to match uv.config.js â€” SW at /uv/ can only control /uv/*
  const UV_PREFIX = "/uv/service/";
  const SW_PATH   = "/uv/sw.js";
  const SW_SCOPE  = "/uv/service/";

  function navigate(url) {
    if (!url) return;
    if (!url.startsWith("http://") && !url.startsWith("https://")) {
      url = url.includes(".") && !url.includes(" ")
        ? "https://" + url
        : "https://www.google.com/search?q=" + encodeURIComponent(url);
    }
    // Use __uv$config if loaded, else fall back to hardcoded prefix
    const prefix = (typeof __uv$config !== "undefined") ? __uv$config.prefix : UV_PREFIX;
    const encode = (typeof __uv$config !== "undefined") ? __uv$config.encodeUrl : (x => encodeURIComponent(x));
    location.href = prefix + encode(url);
  }

  function setInput(url) {
    document.getElementById("url-input").value = url;
    document.getElementById("url-input").focus();
  }

  document.getElementById("go-btn").addEventListener("click", () =>
    navigate(document.getElementById("url-input").value.trim())
  );
  document.getElementById("url-input").addEventListener("keydown", (e) => {
    if (e.key === "Enter") navigate(document.getElementById("url-input").value.trim());
  });

  if ("serviceWorker" in navigator) {
    navigator.serviceWorker
      .register(SW_PATH, { scope: SW_SCOPE })
      .then((reg) => {
        status.textContent = "ready.";
        console.log("SW registered, scope:", reg.scope);
      })
      .catch((e) => {
        status.textContent = "sw error: " + e.message;
        console.error(e);
      });
  } else {
    status.textContent = "service workers not supported.";
  }
</script>
</body>
</html>
